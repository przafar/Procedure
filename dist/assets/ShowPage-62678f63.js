import{J as Ve,a2 as V,d as Ce,$ as $e,r as P,e as Se,a0 as Pe,o as Ee,f as w,a as l,c as i,b as e,t as s,s as Ie,H as h,F as C,x as $,h as u,w as _,i as f,g as oe,u as ae,p as Ue,m as Ne,_ as Re}from"./index-d0dba67e.js";import{a as Ae}from"./appointment-aa586bdf.js";import{S as Oe}from"./services-b8050135.js";import{v as ne}from"./utils-b2fc192b.js";const je=Ve("prescription",{state:()=>({loading:!1,listOfPrescriptions:[],prescriptionInfo:{}}),getters:{getListOfPrescriptions:c=>c.listOfPrescriptions,getPrescriptionInfo:c=>c.prescriptionInfo},actions:{async GET_LIST_OF_PRESCRIPTIONS(c){this.loading=!0;try{const r=await V.get("prescriptions",{params:c});return this.listOfPrescriptions=r.data,r}catch(r){return r}finally{this.loading=!1}},async GET_PRESCRIPTION_BY_ID(c){this.loading=!0;try{const r=await V.get(`prescriptions/${c}`);return this.prescriptionInfo=r.data,r}catch(r){return r}finally{this.loading=!1}},async CREATE_PRESCRIPTION(c){this.loading=!0;try{const r=await V.post("prescriptions",c);return console.log(r,"Prescription created successfully"),r}catch(r){return r}finally{this.loading=!1}},async UPDATE_PRESCRIPTION(c,r){this.loading=!0;try{const m=await V.put(`prescriptions/${c}`,r);return console.log(m,"Prescription updated successfully"),m}catch(m){return m}finally{this.loading=!1}},async DELETE_PRESCRIPTION(c){this.loading=!0;try{const r=await V.delete(`prescriptions/${c}`);return console.log(r,"Prescription deleted successfully"),r}catch(r){return r}finally{this.loading=!1}}}}),N=c=>(Ue("data-v-471d4ead"),c=c(),Ne(),c),Fe={class:"container mx-auto px-4 sm:px-6 py-6 relative"},Le={key:0,class:"grid grid-cols-1 lg:grid-cols-12 gap-6"},Be={class:"col-span-12 lg:col-span-4 bg-white p-4 lg:p-6 rounded-lg shadow-lg"},Me={class:"text-lg lg:text-2xl font-bold text-gray-800 mb-4 lg:mb-6"},qe={class:"space-y-3 lg:space-y-4"},Ge={class:"bg-gray-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"},ze={class:"text-sm lg:text-md font-semibold text-gray-700"},He={class:"text-xs lg:text-sm text-gray-600"},Je={class:"bg-gray-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"},Ye={class:"text-sm lg:text-md font-semibold text-gray-700"},Ze={class:"text-xs lg:text-sm text-gray-600"},Ke={class:"bg-gray-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"},Qe={class:"text-sm lg:text-md font-semibold text-gray-700"},We={class:"text-xs lg:text-sm text-gray-600"},Xe={class:"bg-gray-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"},et={class:"text-sm lg:text-md font-semibold text-gray-700"},tt={class:"text-xs lg:text-sm text-gray-600"},st={class:"col-span-12 lg:col-span-8 bg-white p-4 lg:p-6 rounded-lg shadow-lg"},ot={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 lg:mb-6"},at={class:"text-lg lg:text-2xl font-bold text-gray-800"},nt={class:"mt-3 sm:mt-0 flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4"},lt={class:"text-gray-500 text-xs sm:text-sm"},rt={class:"space-y-3 lg:space-y-4"},it={class:"bg-gray-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"},dt={class:"text-sm lg:text-md font-semibold text-gray-700"},ct={class:"text-xs lg:text-sm text-gray-600"},ut=N(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",class:"w-5 lg:w-8 h-5 lg:h-8 text-blue-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)),pt={class:"text-sm lg:text-md font-semibold text-gray-800"},mt={class:"text-xs lg:text-sm text-gray-500"},gt={class:"bg-gray-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"},ht={class:"text-sm lg:text-md font-semibold text-gray-700"},_t={class:"text-xs lg:text-sm text-gray-600"},yt={class:"mt-8"},ft={class:"flex flex-row items-center mb-4"},xt={class:"text-lg lg:text-2xl font-bold text-gray-800"},vt={key:0,class:"ml-4"},bt={key:0,class:"space-y-4"},wt={class:"mb-2"},Tt={class:"font-semibold text-gray-800"},kt={class:"text-gray-600 text-sm"},Dt={key:1,class:"text-gray-500 mt-8 bg-white p-4 rounded-lg shadow-md"},Vt={class:"self-stretch flex-col justify-start items-start gap-4 flex"},Ct={class:"bg-gray-50 w-full p-4 rounded-lg"},$t={class:"flex gap-4 w-full"},St={class:"w-full"},Pt={class:"mt-4"},Et={class:"w-full mb-2 flex flex-col md:flex-row align-center justify-center items-end"},It={class:"w-full md:w-12 mt-2 md:mt-0 flex justify-end"},Ut=["onClick"],Nt=N(()=>e("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("g",{id:"Iconly/Light/Delete"},[e("g",{id:"Delete"},[e("path",{id:"Stroke 1",d:"M14.4936 7.10107C14.4936 7.10107 14.0863 12.1523 13.8501 14.2801C13.7376 15.2963 13.1098 15.8918 12.0816 15.9106C10.1248 15.9458 8.16584 15.9481 6.20984 15.9068C5.22059 15.8866 4.60334 15.2836 4.49309 14.2853C4.25534 12.1388 3.85034 7.10107 3.85034 7.10107",stroke:"#D10F5C","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{id:"Stroke 3",d:"M15.5311 4.67969H2.81262",stroke:"#D10F5C","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{id:"Stroke 5",d:"M13.0804 4.67974C12.4917 4.67974 11.9847 4.26349 11.8692 3.68674L11.6869 2.77474C11.5744 2.35399 11.1934 2.06299 10.7592 2.06299H7.58443C7.15018 2.06299 6.76918 2.35399 6.65668 2.77474L6.47443 3.68674C6.35893 4.26349 5.85193 4.67974 5.26318 4.67974",stroke:"#D10F5C","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])])],-1)),Rt=[Nt],At={class:"flex flex-row justify-end mt-3"},Ot={class:"w-full mb-4"},jt={class:"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center"},Ft=N(()=>e("h1",null,"Создания рецепта",-1)),Lt={class:"self-stretch flex-col justify-start items-start gap-4 flex"},Bt={class:"bg-gray-50 w-full p-4 rounded-lg"},Mt={class:"w-full"},qt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Gt={class:"col-span-1"},zt={class:"col-span-1"},Ht={class:"col-span-1"},Jt={class:"col-span-1"},Yt={class:"w-full mt-2 md:mt-4 flex flex-col items-end justify-end"},Zt=["onClick"],Kt={class:"flex w-full items-center justify-end"},Qt={class:"flex flex-col w-full"},Wt={class:"w-full mb-4"},Xt={class:"flex gap-2 flex-col-reverse items-stretch justify-end w-full sm:flex-row sm:items-center"},es=Ce({__name:"ShowPage",setup(c){const m=$e().params.id,T=Ae(),E=je(),R=P(!0),o=P(null),I=P(!1),v=P(!1),U=Oe(),le=Se(()=>U.getEncounterClasses),a=Pe({encounterTypesData:[{class:{code:"",display:""},type:[{code:null,display:"",id:""}],typesDatas:[]}],reasonText:"",prescriptionData:{prescribing_doctor:"",medications:[{name:"",dosage:"",frequency:"",duration:""}],notes:"",prescription_date:""}});Ee(async()=>{await y()});const y=async()=>{R.value=!0;try{const t=await T.GET_BY_ID(m);o.value={...t.data}}catch(t){console.error("Failed to fetch patient data:",t)}finally{R.value=!1}},re=t=>{switch(t){case"draft":return"bg-yellow-500";case"in-process":return"bg-blue-500";case"finished":return"bg-green-500";case"entered-in-error":return"bg-red-500";default:return"bg-gray-500"}},ie=t=>t.replace(/-/g," ").replace(/\b\w/g,n=>n.toUpperCase()),de=t=>!t||t.length===0?"No Document":t.map(n=>`${n.display}: ${n.value}`).join(", "),A=t=>{const n=new Date(t),b={timeZone:"Asia/Tashkent",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return n.toLocaleString("en-GB",b).replace(",","")},ce=t=>!t||t.length===0?"No Medications":t.map(n=>`${n.name} (${n.dosage}, ${n.frequency}, ${n.duration})`).join(", "),ue=async()=>{I.value=!0,a.encounterTypesData[0].class.code=o.value.encounter_class.code,a.encounterTypesData[0].class.display=o.value.encounter_class.display,a.encounterTypesData[0].type=o.value.encounter_types?o.value.encounter_types:[{code:"",display:"",id:""}],a.reasonText=o.value.reason_text,await U.GET_LIST_OF_ECOUNTER_CLASSES(),await U.GET_LIST_OF_ECOUNTER_TYPES(o.value.encounter_class.code).then(t=>{a.encounterTypesData[0].typesDatas=t.data.data})},pe=async()=>{const t={status:"in-progress"};await T.UPDATE_STATUS(m,t),await y()},me=async()=>{const t={status:"finished"};await T.UPDATE_STATUS(m,t),await y()},ge=async()=>{const t={status:"entered-in-error"};await T.UPDATE_STATUS(m,t),await y()},O=async t=>{t()},he=()=>{a.encounterTypesData[0].type.push({code:"",display:"",id:""})},_e=async()=>{const n={encounter_types:a.encounterTypesData[0].type.map(b=>b.code),reason_text:a.reasonText,status:"in-progress"};console.log(n,"payload"),await T.UPDATE(m,n),await y()},ye=t=>{a.encounterTypesData[0].type.splice(t,1)},fe=()=>{v.value=!0;const t=JSON.parse(localStorage.getItem("user"));a.prescriptionData.prescribing_doctor=t.fullname},xe=()=>{v.value=!0;const t=JSON.parse(localStorage.getItem("user"));a.prescriptionData.prescribing_doctor=t.fullname,a.prescriptionData.medications=o.value.prescriptions[0].medications,a.prescriptionData.notes=o.value.prescriptions[0].notes},ve=t=>{a.prescriptionData.medications.splice(t,1)},be=()=>{a.prescriptionData.medications.push({name:"",dosage:"",frequency:"",duration:""})},we=async()=>{await E.DELETE_PRESCRIPTION(o.value.prescriptions[0].id),await y()},Te=async()=>{const t={appointment_id:m,prescribing_doctor:a.prescriptionData.prescribing_doctor,medications:a.prescriptionData.medications,notes:a.prescriptionData.notes};await E.CREATE_PRESCRIPTION(t),await y(),v.value=!1},ke=async()=>{const t={prescribing_doctor:a.prescriptionData.prescribing_doctor,medications:a.prescriptionData.medications,notes:a.prescriptionData.notes};await E.UPDATE_PRESCRIPTION(o.value.prescriptions[0].id,t),await y(),v.value=!1};return(t,n)=>{var B,M,q,G,z,H,J,Y,Z,K,Q,W,X,ee,te;const b=w("VaSelect"),j=w("VaTextarea"),k=w("VaButton"),F=w("VaForm"),L=w("VaModal"),D=w("VaInput");return l(),i("div",Fe,[o.value?(l(),i("div",Le,[e("div",Be,[e("h2",Me,s(t.$t("patientInfo")),1),e("div",qe,[e("div",Ge,[e("h3",ze,s(t.$t("patientId")),1),e("p",He,s((B=o.value.patient)==null?void 0:B.id),1)]),e("div",Je,[e("h3",Ye,s(t.$t("fullName")),1),e("p",Ze,s((M=o.value.patient)==null?void 0:M.last_name)+" "+s((q=o.value.patient)==null?void 0:q.first_name)+" "+s((G=o.value.patient)==null?void 0:G.middle_name),1)]),e("div",Ke,[e("h3",Qe,s(t.$t("passport")),1),e("p",We,s(de((z=o.value.patient)==null?void 0:z.identifier)),1)]),e("div",Xe,[e("h3",et,s(t.$t("phoneNumber")),1),e("p",tt,s(((H=o.value.patient)==null?void 0:H.phone_number)||t.$t("noPhoneNumber")),1)])])]),e("div",st,[e("div",ot,[e("h2",at,s(t.$t("appointmentDetails")),1),e("div",nt,[e("div",{class:Ie([re(o.value.status),"px-3 py-1 rounded-lg text-white font-bold text-xs sm:text-sm"])},s(ie(o.value.status)),3),e("div",lt,s(t.$t("createdAt"))+": "+s(A(o.value.created_at)),1),e("button",{onClick:ge,class:"bg-red-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-red-600 transition-colors duration-200"},s(t.$t("enteredInError")),1),o.value.status==="in-progress"?(l(),i("button",{key:0,onClick:ue,class:"bg-blue-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-blue-600 transition-colors duration-200"},s(t.$t("edit")),1)):h("",!0),o.value.status==="in-progress"?(l(),i("button",{key:1,onClick:me,class:"bg-yellow-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-yellow-600 transition-colors duration-200"},s(t.$t("endAppointment")),1)):h("",!0),o.value.status==="draft"?(l(),i("button",{key:2,onClick:pe,class:"bg-green-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-green-600 transition-colors duration-200"},s(t.$t("startAppointment")),1)):h("",!0)])]),e("div",rt,[e("div",it,[e("h3",dt,s(t.$t("primaryEncounterType")),1),e("p",ct,s((J=o.value.encounter_class)==null?void 0:J.display),1)]),(l(!0),i(C,null,$(o.value.encounter_types,p=>(l(),i("div",{key:p.id,class:"bg-blue-50 p-3 lg:p-4 rounded-lg shadow-sm hover:shadow-lg transition-shadow duration-200 flex items-center space-x-2"},[ut,e("div",null,[e("h3",pt,s(p.display),1),e("p",mt,"Code: "+s(p.code),1)])]))),128)),e("div",gt,[e("h3",ht,s(t.$t("reason")),1),e("p",_t,s(o.value.reason_text),1)])])])])):h("",!0),e("div",null,[e("div",yt,[e("div",ft,[e("div",null,[e("h2",xt,s(t.$t("prescriptions")),1)]),o.value&&((Y=o.value)==null?void 0:Y.status)==="in-progress"?(l(),i("div",vt,[(Z=o.value)!=null&&Z.prescriptions.length?h("",!0):(l(),i("button",{key:0,onClick:fe,class:"bg-blue-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-blue-600 transition-colors duration-200"},"Создать рецепт")),(K=o.value)!=null&&K.prescriptions.length?(l(),i("button",{key:1,onClick:xe,class:"bg-green-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-green-600 transition-colors duration-200 ml-4"},"Редактирования рецепта")):h("",!0),(Q=o.value)!=null&&Q.prescriptions&&((W=o.value)==null?void 0:W.prescriptions.length)>0?(l(),i("button",{key:2,onClick:we,class:"ml-4 bg-red-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-red-600 transition-colors duration-200"},"Удалить")):h("",!0)])):h("",!0)]),(X=o.value)!=null&&X.prescriptions&&((ee=o.value)==null?void 0:ee.prescriptions.length)>0?(l(),i("ul",bt,[(l(!0),i(C,null,$((te=o.value)==null?void 0:te.prescriptions,p=>(l(),i("li",{key:p.id,class:"bg-white p-4 rounded-lg shadow-md"},[e("div",wt,[e("h3",Tt,s(t.$t("prescribingDoctor"))+": "+s(p.prescribing_doctor),1)]),e("div",kt,[e("p",null,[e("strong",null,s(t.$t("medications"))+":",1),f(" "+s(ce(p.medications)),1)]),e("p",null,[e("strong",null,s(t.$t("notes"))+":",1),f(" "+s(p.notes||t.$t("noNotes")),1)]),e("p",null,[e("strong",null,s(t.$t("prescriptionDate"))+":",1),f(" "+s(A(p.prescription_date)),1)])])]))),128))])):(l(),i("div",Dt,[e("p",null,s(t.$t("noPrescriptions")),1)]))])]),u(L,{modelValue:I.value,"onUpdate:modelValue":n[2]||(n[2]=p=>I.value=p),size:"large","mobile-fullscreen":"","close-button":"","hide-default-actions":"","before-cancel":O},{default:_(({cancel:p,ok:De})=>[e("h1",null,s(t.$t("addService")),1),u(F,{ref:"add-user-form",class:"flex-col justify-start items-start gap-4 inline-flex w-full mt-4"},{default:_(({isValid:S})=>[e("div",Vt,[(l(!0),i(C,null,$(a.encounterTypesData,d=>(l(),i("div",Ct,[e("div",$t,[e("div",St,[u(b,{modelValue:d.class.code,"onUpdate:modelValue":x=>d.class.code=x,label:t.$t("primaryEncounterType"),class:"w-full",options:le.value,rules:[ae(ne).required],"text-by":"display","value-by":"code",disabled:""},null,8,["modelValue","onUpdate:modelValue","label","options","rules"])])]),e("div",Pt,[(l(!0),i(C,null,$(d.type,(x,g)=>(l(),i("div",Et,[u(b,{modelValue:x.code,"onUpdate:modelValue":se=>x.code=se,label:`${t.$t("encounterType")} #${g+1}`,class:"w-full",options:d.typesDatas,rules:[ae(ne).required],"text-by":"display","value-by":"code"},null,8,["modelValue","onUpdate:modelValue","label","options","rules"]),e("div",It,[e("button",{onClick:se=>ye(g),class:"cursor-pointer"},Rt,8,Ut)])]))),256)),e("div",At,[e("button",{onClick:he,class:"bg-green-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-green-600 transition-colors duration-200"},s(t.$t("add"))+" + ",1)])])]))),256)),e("div",Ot,[u(j,{modelValue:a.reasonText,"onUpdate:modelValue":n[0]||(n[0]=d=>a.reasonText=d),label:t.$t("reason"),class:"w-full"},null,8,["modelValue","label"])]),e("div",jt,[u(k,{preset:"secondary",color:"secondary",onClick:n[1]||(n[1]=d=>t.$emit("close"))},{default:_(()=>[f(s(t.$t("cancel")),1)]),_:1}),u(k,{disabled:!S,onClick:_e},{default:_(()=>[f(s(t.$t("save")),1)]),_:2},1032,["disabled"])])])]),_:1},512)]),_:1},8,["modelValue"]),u(L,{modelValue:v.value,"onUpdate:modelValue":n[6]||(n[6]=p=>v.value=p),size:"large","mobile-fullscreen":"","close-button":"","hide-default-actions":"","before-cancel":O},{default:_(({cancel:p,ok:De})=>[Ft,u(F,{ref:"add-user-form",class:"flex-col justify-start items-start gap-4 inline-flex w-full mt-4"},{default:_(({isValid:S})=>[e("div",Lt,[(l(!0),i(C,null,$(a.prescriptionData.medications,(d,x)=>(l(),i("div",Bt,[e("div",Mt,[e("div",qt,[e("div",Gt,[u(D,{modelValue:d.name,"onUpdate:modelValue":g=>d.name=g,placeholder:"Name",label:"Medication Name"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",zt,[u(D,{modelValue:d.dosage,"onUpdate:modelValue":g=>d.dosage=g,placeholder:"Dosage",label:"Dosage"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Ht,[u(D,{modelValue:d.duration,"onUpdate:modelValue":g=>d.duration=g,placeholder:"Duration",label:"Duration"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",Jt,[u(D,{modelValue:d.frequency,"onUpdate:modelValue":g=>d.frequency=g,placeholder:"Frequency",label:"Frequency"},null,8,["modelValue","onUpdate:modelValue"])])])]),e("div",Yt,[x===1?(l(),i("button",{key:0,onClick:g=>ve(x),class:"bg-red-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-red-600 transition-colors duration-200"}," Удалить ",8,Zt)):h("",!0)])]))),256)),e("div",Kt,[e("button",{onClick:be,class:"bg-green-500 text-white px-3 py-1 rounded-lg text-xs sm:text-sm hover:bg-green-600 transition-colors duration-200 mt-2"},s(t.$t("add"))+" + ",1)]),e("div",Qt,[u(D,{modelValue:a.prescriptionData.prescribing_doctor,"onUpdate:modelValue":n[3]||(n[3]=d=>a.prescriptionData.prescribing_doctor=d),placeholder:"Full name",label:"Doctor"},null,8,["modelValue"])]),e("div",Wt,[u(j,{modelValue:a.prescriptionData.notes,"onUpdate:modelValue":n[4]||(n[4]=d=>a.prescriptionData.notes=d),label:t.$t("note"),class:"w-full"},null,8,["modelValue","label"])]),e("div",Xt,[u(k,{preset:"secondary",color:"secondary",onClick:n[5]||(n[5]=d=>t.$emit("close"))},{default:_(()=>[f(s(t.$t("cancel")),1)]),_:1}),o.value.prescriptions.length?(l(),oe(k,{key:1,disabled:!S,onClick:ke},{default:_(()=>[f(s(t.$t("update")),1)]),_:2},1032,["disabled"])):(l(),oe(k,{key:0,disabled:!S,onClick:Te},{default:_(()=>[f(s(t.$t("save")),1)]),_:2},1032,["disabled"]))])])]),_:1},512)]),_:1},8,["modelValue"])])}}});const ns=Re(es,[["__scopeId","data-v-471d4ead"]]);export{ns as default};
//# sourceMappingURL=ShowPage-62678f63.js.map
