import{d as w,f as p,a as v,g as P,r as u,u as m}from"./index-a004be18.js";import{s as l}from"./utils-b2fc192b.js";import{p as o,u as d}from"./users-db-c5bad630.js";import{w as _}from"./index-742cfd87.js";const F=w({__name:"UserAvatar",props:{user:{type:Object,required:!0},size:{type:String,default:"medium"}},setup(e){const a=t=>{const r=["primary","#FFD43A","#ADFF00","#262824","danger"],i=t.charCodeAt(0)%r.length;return r[i]},n=t=>t.startsWith("http")||t.startsWith("blob:");return(t,r)=>{const i=p("VaAvatar");return v(),P(i,{size:e.size,src:n(e.user.avatar)?e.user.avatar:"","fallback-text":e.user.avatar||e.user.fullname[0],color:a(e.user.fullname)},null,8,["size","src","fallback-text","color"])}}}),f=(e,a)=>a==="project_owner"?e.project_owner.fullname:a==="team"?e.team.map(n=>n.fullname).join(", "):a==="creation_date"?new Date(e[a]):e[a],h=async e=>{await l(1e3);const a=o.map(t=>({...t,project_owner:d.find(r=>r.id===t.project_owner),team:d.filter(r=>t.team.includes(r.id))}));return e.sortBy&&e.sortingOrder&&a.sort((t,r)=>(t=f(t,e.sortBy),r=f(r,e.sortBy),t<r?e.sortingOrder==="asc"?-1:1:t>r?e.sortingOrder==="asc"?1:-1:0)),{data:a.slice((e.page-1)*e.perPage,e.page*e.perPage),pagination:{page:e.page,perPage:e.perPage,total:o.length}}},y=async e=>{await l(1e3);const a={...e,id:o.length+1,creation_date:new Date().toLocaleDateString("gb",{day:"numeric",month:"short",year:"numeric"})};return o.push(a),{...a,project_owner:d.find(n=>n.id===e.project_owner),team:d.filter(n=>e.team.includes(n.id))}},j=async e=>{await l(1e3);const a=o.findIndex(n=>n.id===e.id);return o[a]=e,e},x=async e=>{await l(1e3);const a=o.findIndex(n=>n.id===e.id);return o.splice(a,1),e},D=()=>u({page:1,perPage:10,total:0}),k=()=>u({sortBy:"creation_date",sortingOrder:"desc"}),I=e=>{const a=u(!1),n=u([]),{sorting:t=k(),pagination:r=D()}=e??{},i=async()=>{a.value=!0;const{data:s,pagination:c}=await h({...m(t),...m(r)});n.value=s,g(()=>{r.value=c}),a.value=!1},{ignoreUpdates:g}=_([r,t],i,{deep:!0});return i(),{isLoading:a,projects:n,fetch:i,async add(s){a.value=!0,await y({...s,project_owner:s.project_owner.id,team:s.team.map(c=>c.id)}),await i(),a.value=!1},async update(s){a.value=!0,await j({...s,project_owner:s.project_owner.id,team:s.team.map(c=>c.id)}),await i(),a.value=!1},async remove(s){a.value=!0,await x({...s,project_owner:s.project_owner.id,team:s.team.map(c=>c.id)}),await i(),a.value=!1},pagination:r,sorting:t}};export{F as _,I as u};
//# sourceMappingURL=useProjects-b491c298.js.map
